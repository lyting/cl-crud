!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n=t();for(var r in n)("object"==typeof exports?exports:e)[r]=n[r]}}(window,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=5)}([function(e,t){var n=/^(attrs|props|on|nativeOn|class|style|hook)$/;function r(e,t){return function(){e&&e.apply(this,arguments),t&&t.apply(this,arguments)}}e.exports=function(e){return e.reduce((function(e,t){var i,o,a,s,c;for(a in t)if(i=e[a],o=t[a],i&&n.test(a))if("class"===a&&("string"==typeof i&&(c=i,e[a]=i={},i[c]=!0),"string"==typeof o&&(c=o,t[a]=o={},o[c]=!0)),"on"===a||"nativeOn"===a||"hook"===a)for(s in o)i[s]=r(i[s],o[s]);else if(Array.isArray(i))e[a]=i.concat(o);else if(Array.isArray(o))e[a]=[i].concat(o);else for(s in o)i[s]=o[s];else e[a]=t[a];return e}),{})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(0),o=(r=i)&&r.__esModule?r:{default:r},a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},s=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.debounce=function(e,t){var n=null;return function(){var r=arguments,i=this;n?(clearTimeout(n),n=setTimeout((function(){e.apply(i,r)}),t)):n=setTimeout((function(){e.apply(i,r)}),t)}},t.isArray=d,t.isObject=f,t.isNumber=function(e){return!isNaN(Number(e))},t.isFunction=function(e){return"function"==typeof e},t.isString=function(e){return"string"==typeof e},t.isEmpty=p,t.cloneDeep=function e(t){var n=d(t)?t:{};if(f(t))for(var r in t)t.hasOwnProperty&&t.hasOwnProperty(r)&&(t[r]&&"object"===c(t[r])?n[r]=e(t[r]):n[r]=t[r]);return n},t.clone=function(e){return Object.create(Object.getPrototypeOf(e),Object.getOwnPropertyDescriptors(e))},t.certainProperty=function(e,t){return t.reduce((function(t,n){return e.hasOwnProperty(n)&&(t[n]=e[n]),t}),{})},t.dataset=function(e,t,n){for(var r=e,i=t.split(".").map((function(e){return e.includes("[")?e.split("[").map((function(e){return e.replace(/"/g,"")})):e})).flat(),o=0;o<i.length;o++){var a=i[o],c=null;if(a.includes("]")?function(){var e=a.replace("]","").split(":"),t=s(e,2),n=t[0],i=t[1];c=i?r.findIndex((function(e){return e[n]==i})):Number(c)}():c=a,o!=i.length-1)r=r[c];else{if(p(n))return r[c];r[c]=n}}return e},t.print=function(e,t){if(console.log(e),t)if("object"==(void 0===t?"undefined":c(t))){var n={};for(var r in t)n[r]=t[r];console.table?console.table(n):console.log(n)}else console.log(t);else console.log(t)},t.deepMerge=function e(t,n){var r=void 0;for(r in n)t[r]=t[r]&&"[object Object]"===t[r].toString()?e(t[r],n[r]):t[r]=n[r];return t},t.renderLayout=function(e){var t=this.$createElement;if("string"==typeof e){if(!e.includes("slot-"))return t(e);var n=this.$scopedSlots[e];if(n)return n()}else{if(e.render)return e.name?(this.$root.$options.components[e.name]||u.__vue.component(e.name,e),t(e.name,e)):(console.error("Component name is required"),t("span"));if(e.context)return e}},t.renderForm=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=this.$createElement,r=t.appendEl,i=this.items.map((function(t,r){if(!t.hidden){var i,s=null,c=t.component||{},d=c.name,f=c.attrs,p=void 0===f?{}:f,h=c.props,m=c.on,v=void 0===m?{}:m,b=c.options,g=void 0===b?[]:b,y=c.children,x=void 0===y?[]:y,_=c.context,w=c.render,j=c.domProps,k=void 0===j?{}:j,O=c.style,S=void 0===O?{}:O,M=c.class,P=void 0===M?{}:M,z=c.nativeOn,$=void 0===z?{}:z,E=c.directives,T=void 0===E?{}:E,A=c.scopedSlots,R=void 0===A?{}:A,C=c.slot,q=c.key,F=c.ref,B=c.refInFor,N=a({},t.component,(l(i={},"class",P),l(i,"domProps",k),l(i,"style",S),l(i,"nativeOn",$),l(i,"directives",T),l(i,"scopedSlots",R),l(i,"slot",C),l(i,"key",q),l(i,"ref",F),l(i,"refInFor",B),l(i,"attrs",a({},p,{value:e.form[t.prop]})),l(i,"props",h),l(i,"on",a({input:function(n){e.form[t.prop]=n}},v)),i));if(_)s=t.component;else if(w)d||(d="error-text",N.domProps.innerHTML="Component name is required",N.style.color="red"),e.$root.$options.components[d]||u.__vue.component(d,N),s=n(d,N);else if(d)if(d.includes("slot-")){var L=e.crud?e.crud.$scopedSlots[d]:e.$scopedSlots[d];L&&(s=L({scope:e.form}))}else{switch(d){case"el-select":x=g.map((function(e,t){return n("el-option",(0,o.default)([{key:t,attrs:{label:e.label,value:e.value}},{props:e.props}]))}));break;case"el-radio-group":x=g.map((function(e,t){return n("el-radio",(0,o.default)([{key:t,attrs:{label:e.value}},{props:e.props}]),[e.label])}));break;case"el-checkbox-group":x=g.map((function(e,t){return n("el-checkbox",(0,o.default)([{key:t,attrs:{label:e.value}},{props:e.props}]),[e.label])}))}s=n(d,N,x)}return n("el-col",{attrs:{span:t.span,offset:t.offset},key:r},[n("el-form-item",(0,o.default)([{attrs:{label:t.label,prop:t.prop,rules:t.rules}},{props:t.props}]),[s])])}}));return n("el-form",(0,o.default)([{ref:"form",class:"cl-form"},{props:a({disabled:this.saving,model:this.form},this.props)}]),[n("el-row",{directives:[{name:"loading",value:this.loading}]},[i,r])])},t.contains=function(e,t){if(document.documentElement.contains)return e!==t&&e.contains(t);for(;t&&(t=t.parentNode);)if(t===e)return!0;return!1};var u=n(2);function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(e){return"function"==typeof Array.isArray?Array.isArray(e):"[object Array]"===Object.prototype.toString.call(e)}function f(e){return"[object Object]"===Object.prototype.toString.call(e)}function p(e){return d(e)?0===e.length:f(e)?0===Object.keys(e).length:""===e||null==e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.__crud={},t.__vue={}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=n(1);t.default={inject:["crud"],data:function(){return{items:[],props:{},visible:!1}},methods:{search:function(){var e=this,t=(0,i.cloneDeep)(this.form),n=this.crud.fn,r=function(t){e.crud.refresh(t)};n.advSearch?n.advSearch(t,{next:r}):r(t),this.close()},open:function(){var e=this,t=this.crud.search.adv,n=t.items,r=t.props,i=t.form;n&&(this.items=n),r&&(this.props=r),this.visible=!0,this.form=i,this.items.map((function(t){void 0===e.form[t.prop]&&e.$set(e.form,t.prop,t.value)}))},close:function(){this.visible=!1},reset:function(){var e=this;this.items.forEach((function(t){return e.form[t.prop]=t.value})),this.$refs.form.resetFields()}},render:function(){var e=this,t=arguments[0],n=this.crud.search.adv,o=n.on,a=n.props,s=void 0===a?{}:a,c=n.attrs,u=n.title,l=n.op,d=i.renderForm.call(this);return this.visible&&t("el-drawer",{attrs:c,props:r({direction:"rtl",title:u},s,{visible:this.visible}),on:r({"update:visible":function(t){e.visible=t}},o)},[t("div",{class:"crud-adv-search__drawer"},[t("div",{class:"crud-adv-search__drawer-container"},[d]),t("div",{class:"crud-adv-search__drawer-footer"},[t("el-button",{attrs:{size:"medium",type:"primary"},on:{click:this.search}},[l.confirmButtonText]),t("el-button",{attrs:{size:"medium"},on:{click:this.reset}},[l.resetButtonText])])])])}}},function(e,t,n){var r=n(19);"string"==typeof r&&(r=[[e.i,r,""]]);var i={insert:"head",singleton:!1};n(21)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n(6);var r=n(2),i=n(1),o=s(n(7)),a=s(n(22));function s(e){return e&&e.__esModule?e:{default:e}}t.default={install:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.crud,s=t.version,c=void 0===s?"":s,u=function(e){return""+e+c};(0,i.deepMerge)(r.__crud,n),(0,i.deepMerge)(r.__vue,e),e.component(u("cl-crud"),o.default),e.component(u("cl-form"),a.default)}}},function(e,t,n){"use strict";Promise.prototype.done=function(e){var t=this.constructor;return this.then((function(n){return t.resolve(e()).then((function(){return n}))}),(function(n){return t.resolve(e()).then((function(){throw n}))}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=y(n(0)),i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o=y(n(8)),a=y(n(3)),s=y(n(9)),c=y(n(10)),u=y(n(11)),l=y(n(12)),d=y(n(13)),f=y(n(14)),p=y(n(15)),h=y(n(16)),m=y(n(17)),v=n(1),b=n(18),g=n(2);function y(e){return e&&e.__esModule?e:{default:e}}n(4),t.default={name:"cl-crud",provide:function(){return{crud:this}},data:function(){return{service:null,conf:{UPSERT_REFRESH:!0,DELETE_REFRESH:!0},permission:{add:!0,delete:!0,update:!0,info:!0},fn:{open:null,close:null,submit:null,refresh:null,delete:null,info:null,permission:null,advSearch:null},dict:{api:{list:"list",add:"add",update:"update",delete:"delete",info:"info",page:"page"},pagination:{page:"page",size:"size"},search:{keyWord:"keyWord",query:"query"},sort:{order:"order",prop:"prop"},label:{add:"添加",delete:"删除",update:"编辑",refresh:"刷新",advSearch:"高级搜素"}},tips:{add:{success:"新增成功",error:""},update:{success:"修改成功",error:""},delete:{confirm:"此操作将永久删除选中数据，是否继续？",success:"删除成功",error:""}},table:{visible:!0,loading:!1,data:[],columns:[],selection:[],props:{border:!0,stripe:!1,size:"mini","element-loading-text":"拼命加载中...","element-loading-background":"rgba(255, 255, 255, 0.7)","element-loading-spinner":"el-icon-loading"},on:{},op:{props:{width:150,align:"center",fixed:"right",label:"操作"},visible:!0,layout:["edit","delete"]}},search:{query:{list:[],value:null,multiple:!1,callback:null},key:{placeholder:"请输入关键字",selected:"",value:"",list:[],props:{}},adv:{title:"高级搜索",visible:!1,type:"drawer",items:[],form:{},props:{size:"small","label-width":"120px"},op:{visible:!1,confirmButtonText:"确定",resetButtonText:"重置","label-width":"120px"}}},upsert:{form:{},items:[],props:{width:"",labelWidth:"80px","append-to-body":!0,"close-on-click-modal":!1,size:"small"},op:{confirmButtonText:"保存",cancelButtonText:"取消",layout:["cancel","confirm"]}},pagination:{props:{background:!0,small:!1,layout:"total, sizes, prev, pager, next, jumper","page-sizes":[20,50,100,200]},size:20,page:1,total:0},layout:[["refresh-btn","add-btn","multi-delete-btn","query","flex1","search-key","adv-btn"],["data-table"],["flex1","pagination"]],refs:{},params:{},temp:{refreshRd:null,sortLock:!1},process:{status:!1}}},components:{Query:o.default,AdvSearch:a.default,DataTable:s.default,Upsert:c.default,RefreshBtn:u.default,AddBtn:d.default,MultiDeleteBtn:f.default,SearchKey:m.default,AdvBtn:p.default,Pagination:h.default,Flex1:l.default},mounted:function(){this.$emit("load",(0,b.bootstrap)((0,v.deepMerge)(this,g.__crud)))},methods:{rowAdd:function(){this.$refs.upsert.add()},rowEdit:function(e){this.$refs.upsert.edit(e)},rowAppend:function(e){this.$refs.upsert.append(e)},rowClose:function(){this.$refs.upsert.hide()},rowDelete:function(){for(var e=this,t=this.tips.delete,n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];var o={ids:r.map((function(e){return e.id})).join(",")},a=function(n){return new Promise((function(r,i){e.$confirm(t.confirm,"提示",{type:"warning"}).then((function(o){if("confirm"==o){var a=e.dict.api.delete;if(!e.service[a])return i("Request function '"+a+"' is not fount");e.service[a](n).then((function(n){e.$message.success(t.success),e.conf.DELETE_REFRESH&&e.refresh(),r(n)})).catch((function(n){e.$message.error(t.error||n),i(n)}))}})).catch((function(){}))}))};this.fn.delete?this.fn.delete(r,{next:a}):a(o)},deleteMulti:function(){this.rowDelete.apply(this,this.table.selection||[])},openAdvSearch:function(){this.$refs["adv-search"].open()},closeAdvSearch:function(){this.$refs["adv-search"].close()},changeSort:function(e,t){"desc"==t&&(t="descending"),"asc"==t&&(t="ascending"),this.$refs.table.sort(this.table.sort.prop,""),this.$refs.table.sort(e,t),this.table.sort={prop:e,order:t}},sortChange:function(e){var t=e.prop,n=e.order;"descending"==n&&(n="desc"),"ascending"==n&&(n="asc"),this.temp.sortLock&&this.refresh({prop:t,order:n,page:1})},clearSort:function(){this.$refs.table.clearSort()},paramsReplace:function(e){var t=this.dict,n=t.pagination,r=t.search,o=t.sort,a=i({},e),s=i({},n,r,o);for(var c in s)a.hasOwnProperty(c)&&c!=s[c]&&(a["_"+s[c]]=a[c],delete a[c]);for(var u in a)"_"==u[0]&&(a[u.substr(1)]=a[u],delete a[u]);return a},refresh:function(e){var t=this;this.params.page=this.pagination.page,this.params.size=this.pagination.size;var n=this.paramsReplace((0,v.deepMerge)(this.params,e));(0,v.print)("请求参数",n),this.table.loading=!0;var r=this.temp.refreshRd=Math.random(),i=function(){t.table.loading=!1},o=function(e){t.table.data=e,i()},a=function(e){return new Promise((function(n,a){var s=t.dict.api.page;if(!t.service[s])return t.table.loading=!1,a("Request function '"+s+"' is not fount");t.service[s](e).then((function(e){if(r!=t.temp.refreshRd)return!1;Object.assign(t.pagination,e.pagination),o(e.list),i(),n(e)})).catch((function(e){t.$message.error(e),i(),a(e)})).done((function(){t.temp.sortLock=!0}))}))};this.fn.refresh?this.fn.refresh(n,{next:a,done:i,render:o}):a(n)},done:function(){this.process.status=!0}},render:function(){var e=this,t=arguments[0],n=function(n){return"data-table"==n?t("data-table",(0,r.default)([{ref:"table"},{scopedSlots:e.$scopedSlots,on:{"sort-change":e.sortChange}}])):v.renderLayout.call(e,n)},i=this.layout.map((function(e){return e instanceof Array?t("el-row",{attrs:{type:"flex"}},[e.map((function(e){return n(e)}))]):n(e)}));return this.process.status&&t("div",{class:"crud-index"},[t("adv-search",{ref:"adv-search"}),t("upsert",{ref:"upsert"}),i])}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={inject:["crud"],computed:{list:function(){var e=this,t=this.crud.search.query,n=t.value,r=t.multiple,i=t.list,o=[];return o=n instanceof Array?n:[n],r||o.splice(1),i.map((function(t){return e.$set(t,"active",o.some((function(e){return e===t.value}))),t}))}},methods:{selectRow:function(e){var t=this.crud.search.query,n=t.list,r=t.multiple,i=t.callback;e.active?e.active=!1:r?e.active=!0:n.map((function(t){t.active=t.value==e.value}));var o=n.filter((function(e){return e.active})).map((function(e){return e.value}));i?i(o):this.crud.refresh({query:r?o:o[0]})}},render:function(){var e=this,t=arguments[0];return t("div",{class:"crud-query"},[this.list.map((function(n,r){return t("button",{class:{active:n.active},on:{click:function(){e.selectRow(n)}},key:r},[t("span",[n.label])])}))])}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(0),o=(r=i)&&r.__esModule?r:{default:r},a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};t.default={name:"data-table",inject:["crud"],computed:{table:function(){return this.crud.table}},data:function(){return{maxHeight:null}},methods:{column_handler:function(e){var t=e.row[e.prop];if(e.dict){var n=e.dict.find((function(e){return e.value==t}));n&&(t=n.label)}return e.slot?"":t||e.emptyText},sort:function(e,t){this.$refs.table.sort(e,t)},clearSort:function(){this.$refs.table.clearSort()},selectionChange:function(e){var t=(this.table.on||{})["selection-change"];this.table.selection=e,t&&t(e)},sortChange:function(e){this.$emit("sort-change",e)},calcHeight:function(){var e=document.querySelector(".crud-index"),t=(this.table.props||{}).height,n=void 0===t?"":t;if(e){for(var r=document.querySelectorAll(".crud-index > .el-row"),i=20,o=0;o<r.length;o++){for(var a=!0,s=0;s<r[o].childNodes.length;s++)"data-table"==r[o].childNodes[s].className&&(a=!1);a&&(i+=r[o].clientHeight+10)}var c=Number(String(n).replace("px","")),u=e.clientHeight-i;this.maxHeight=c>u?c:u}},resize:function(){this.calcHeight()}},mounted:function(){var e=this;window.onresize=function(){e.resize()},this.resize()},render:function(){var e=this,t=arguments[0],n=this.crud,r=n.rowEdit,i=n.rowDelete,s=n.dict,c=n.permission,u=this.table,l=u.data,d=u.props,f=u.on,p=u.columns,h=u.op,m=u.loading,v=p.filter((function(e){return!e.hidden})).map((function(n){var r={props:n,on:n.on};return n.type||(r.scopedSlots={default:function(t){var r=e.$scopedSlots["table-column-"+n.prop],i=a({},t,n);return r?r({scope:i}):e.column_handler(i)},header:function(t){var r=e.$scopedSlots["table-header-"+n.prop];return r?r({scope:t}):t.column.label}}),t("el-table-column",r)})),b=t("el-table-column",{props:h.props,scopedSlots:{default:function(n){return t("div",{class:"column-op"},[h.layout.map((function(a){if("string"==typeof a)if(a.includes("slot-")){var u=e.$scopedSlots[a];if(u)return u({scope:n})}else switch(a){case"edit":return c.update&&t("el-button",(0,o.default)([{attrs:{size:"mini",type:"text"}},{on:{click:function(){r(n.row)}}}]),[s.label.update]);case"delete":return c.delete&&t("el-button",(0,o.default)([{attrs:{size:"mini",type:"text"}},{on:{click:function(){i(n.row)}}}]),[s.label.delete])}}))])}}});return t("div",{class:"data-table"},[t("el-table",(0,o.default)([{ref:"table",attrs:{data:l,"max-height":this.maxHeight+"px"},on:{"selection-change":this.selectionChange,"sort-change":this.sortChange},directives:[{name:"loading",value:m}]},{on:f,props:d}]),[v,h.visible&&b])])}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(0),o=(r=i)&&r.__esModule?r:{default:r},a=n(1);t.default={inject:["crud"],data:function(){return{visible:!1,loading:!1,saving:!1,isEdit:!1,items:[],op:{},form:{},props:{}}},methods:{open:function(e){var t=this,n=this.crud.upsert,r=n.props,i=n.items,o=n.op;this.visible=!0,this.items=i,this.props=r,this.op=o,this.items.forEach((function(e){t.$set(t.form,e.prop,e.value)})),this.$nextTick((function(){e&&e()}))},close:function(){this.$refs.form.resetFields(),this.visible=!1,this.form={},this.emit("close",this.isEdit)},emit:function(e){var t=this.crud.fn[e];if(t){for(var n=arguments.length,r=Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];t.apply(this,r)}},edit:function(e){var t=this,n=this.crud,r=n.fn,i=n.dict,o=n.service,a=function(e){for(var n in e)t.form[n]=e[n];t.emit("open",!0,t.form),t.loading=!1},s=function(e){return new Promise((function(n,r){var s=i.api.info;if(!o[s])return t.loading=!1,r("Request function '"+s+"' is not fount");o[s]({id:e.id}).then((function(e){a(e),n(e)})).catch((function(e){t.$message.error(e),r(e)})).done((function(){t.loading=!1}))}))};this.loading=!0,this.isEdit=!0,this.open((function(){r.info?t.emit("info",e,{next:s,done:a}):s(e)}))},add:function(){var e=this;this.isEdit=!1,this.open((function(){e.emit("open",null)}))},append:function(e){var t=this;this.isEdit=!1,this.open((function(){e&&Object.assign(t.form,e),t.emit("open",e)}))},save:function(){var e,t=this;this.$refs.form.validate((e=function(e){return function(){var t=e.apply(this,arguments);return new Promise((function(e,n){return function r(i,o){try{var a=t[i](o),s=a.value}catch(e){return void n(e)}if(!a.done)return Promise.resolve(s).then((function(e){r("next",e)}),(function(e){r("throw",e)}));e(s)}("next")}))}}(regeneratorRuntime.mark((function e(n){var r,i,o,a,s,c,u,l,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){for(d in r=t.crud,i=r.conf,o=r.dict,a=r.service,s=r.fn,c=function(){t.saving=!1},u=function(e){var n=t.isEdit?"update":"add",r=t.crud.tips[n];return new Promise((function(s,c){var u=o.api[n];if(!a[u])return t.saving=!1,c("Request function '"+u+"' is not fount");a[u](e).then((function(e){t.$message.success(r.success),t.close(),i.UPSERT_REFRESH&&t.crud.refresh(),s(e)})).catch((function(e){t.$message.error(r.error||e),c(e)})).done((function(){t.saving=!1}))}))},l=Object.create(null),t.form)l[d]=t.form[d];t.saving=!0,s.submit?t.emit("submit",t.isEdit,l,{next:u,done:c}):u(l)}case 1:case"end":return e.stop()}}),e,t)}))),function(t){return e.apply(this,arguments)}))}},render:function(){var e=this,t=arguments[0],n=a.renderForm.call(this),r=this.op,i=r.confirmButtonText,s=r.cancelButtonText,c=r.layout;return this.visible&&t("el-dialog",(0,o.default)([{class:"crud-upsert-dialog",attrs:{visible:this.visible,title:this.isEdit?"编辑":"新增"}},{props:this.props,on:{close:this.close}}]),[n,t("template",{slot:"footer"},[c.map((function(n){return"confirm"==n?t("el-button",(0,o.default)([{attrs:{size:e.props.size,type:"success"}},{on:{click:e.save},props:{loading:e.saving,disabled:e.loading}}]),[i]):"cancel"==n?t("el-button",{attrs:{size:e.props.size},on:{click:e.close}},[s]):a.renderLayout.call(e,n)}))])])}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"refresh-btn",inject:["crud"],render:function(){var e=this,t=arguments[0];return t("el-button",{attrs:{size:"mini"},on:{click:function(){e.crud.refresh()}}},[this.crud.dict.label.refresh])}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"flex1",render:function(){var e=arguments[0];return e("div",{style:"flex: 1"})}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"add-btn",inject:["crud"],render:function(){var e=arguments[0],t=this.crud,n=t.rowAdd,r=t.dict,i=t.permission;return i.add&&e("el-button",{attrs:{size:"mini",type:"primary"},on:{click:n}},[r.label.add])}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"multi-delete-btn",inject:["crud"],render:function(){var e=arguments[0],t=this.crud,n=t.dict,r=t.deleteMulti,i=t.table,o=t.permission;return o.delete&&e("el-button",{attrs:{size:"mini",type:"danger",disabled:0==i.selection.length},on:{click:r}},[n.label.delete])}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(3),o=(r=i)&&r.__esModule?r:{default:r};t.default={name:"adv-btn",inject:["crud"],components:{AdvSearch:o.default},render:function(){var e=arguments[0],t=this.crud,n=t.openAdvSearch,r=t.dict;return e("div",{class:"crud-adv-btn"},[e("el-button",{attrs:{size:"mini"},on:{click:n}},[e("i",{class:"el-icon-search"}),r.label.advSearch])])}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(0),o=(r=i)&&r.__esModule?r:{default:r};t.default={name:"pagination",inject:["crud"],methods:{currentChange:function(e){this.crud.refresh({page:e})},sizeChange:function(e){this.crud.pagination.size=e,this.crud.refresh({size:e})}},render:function(){var e=arguments[0],t=this.crud.pagination,n=t.props,r=t.page,i=t.size,a=t.total;return e("el-pagination",(0,o.default)([{on:{"size-change":this.sizeChange,"current-change":this.currentChange}},n,{attrs:{layout:n.layout,"current-page":r,"page-size":i,total:a}}]))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(0),o=(r=i)&&r.__esModule?r:{default:r};t.default={name:"search-key",inject:["crud"],methods:{onKeyup:function(e){13===e.keyCode&&this.search()},onChange:function(){this.crud.search.key.value=""},search:function(){var e=this,t=this.crud.search.key,n=t.value,r=t.selected;t.list.forEach((function(t){e.crud.params[t.value]=""})),this.crud.refresh(function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},r||"keyWord",n))}},render:function(){var e=this,t=arguments[0],n=this.crud.search,r=n.key,i=r.list,a=r.placeholder,s=[];return i.forEach((function(e,n){s.push(t("el-option",{key:n,attrs:{label:e.label,value:e.value}}))})),t("div",{class:"search-key"},[t("el-select",(0,o.default)([{class:"_select",attrs:{value:e.crud.search.key.selected},on:{input:function(t){e.crud.search.key.selected=t}}},{directives:[{name:"model",value:e.crud.search.key.selected}]},{attrs:{filterable:!0,size:"mini"},on:{change:this.onChange},directives:[{name:"show",value:s.length>0}]}]),[s]),t("el-input",(0,o.default)([{class:"_input",attrs:{value:e.crud.search.key.value},on:{input:function(t){e.crud.search.key.value=t}}},{directives:[{name:"model",value:e.crud.search.key.value}]},{attrs:{placeholder:a,clearable:!0,size:"mini"},nativeOn:{keyup:this.onKeyup}}])),t("el-button",{class:"_button",attrs:{type:"primary",size:"mini"},on:{click:this.search}},["搜索"])])}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;var r=n(1);t.bootstrap=function(e){e.table,e.upsert,e.tips,e.dict;var t,n=e.conf,i=(e.search,e.layout,e.refresh),o=e.params,a=(e.pagination,e.permission,e.fn),s={refs:function(t){var n=e.$refs,r=n.upsert,i=n.table,o=n["adv-search"],a=e.refs={table:i.$refs.table,upsert:r,advSearch:o};return t?a[t]:a},component:function(){return e},data:function(t){return(0,r.dataset)((0,r.certainProperty)(e,["service","conf","tips","dict","table","search","upsert","pagination","params","layout"]),t)},setData:function(t,n){(0,r.deepMerge)(e,(0,r.dataset)((0,r.certainProperty)(e,["service","conf","tips","dict","table","search","upsert","pagination","params","layout"]),t,n))},changeSort:function(t,n){e.changeSort(t,n)},clearSort:function(){e.clearSort()},delete:function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];e.rowDelete.apply(this,n)},info:function(t){return e.service.info(t)},add:function(t){e.rowAdd(t)},append:function(t){e.rowAppend(t)},edit:function(t){e.rowEdit(t)},close:function(t){e.rowClose(t)},renderList:function(t){e.table.data=t,e.table.loading=!1},refresh:function(t){(0,r.isFunction)(t)?t(e.params,i):i(t)}},c=function t(n){return(0,r.deepMerge)(e,n),t};return c.conf=function(e){return(0,r.deepMerge)(n,e),c},c.service=function(t){return e.service=t,c},c.permission=function(t){return(0,r.isFunction)(t)?a.permission=t:((0,r.deepMerge)(e.permission,t),a.permission=null),c},c.set=function(t,n){var i=e[t],a=(0,r.isFunction)(n)?n(i):n;if("table"==t&&a.props){var s=a.props["default-sort"]||{},u=s.order,l=s.prop;o.order=u?"descending"==u?"desc":"asc":"",o.prop=l}return"adv"==t&&(i=e.search.adv),"layout"==t?e[t]=a:(0,r.deepMerge)(i,a),c},c.on=function(t,n){return e.fn[t]=n,c},c.done=(t=function(e){return function(){var t=e.apply(this,arguments);return new Promise((function(e,n){return function r(i,o){try{var a=t[i](o),s=a.value}catch(e){return void n(e)}if(!a.done)return Promise.resolve(s).then((function(e){r("next",e)}),(function(e){r("throw",e)}));e(s)}("next")}))}}(regeneratorRuntime.mark((function t(n){var i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=function(){e.done(),a.permission&&Object.assign(e.permission,a.permission(e))},!(0,r.isFunction)(n)){t.next=6;break}return t.next=4,n(i);case 4:t.next=7;break;case 6:i();case 7:console.log("ctx done");case 8:case"end":return t.stop()}}),t,void 0)}))),function(e){return t.apply(this,arguments)}),{ctx:c,app:s}}},function(e,t,n){(e.exports=n(20)(!1)).push([e.i,".crud-index {\n  background-color: #fff;\n  padding: 10px;\n  box-sizing: border-box;\n  overflow: hidden;\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  position: relative;\n}\n.crud-index>.el-row {\n  margin-bottom: 10px;\n}\n.crud-index>.el-row:last-child {\n  margin-bottom: 0;\n}\n.crud-index .flex1 {\n  flex: 1;\n}\n.crud-index .search-key {\n  display: flex;\n}\n.crud-index .search-key ._input {\n  width: 250px;\n}\n.crud-index .search-key ._select {\n  width: 150px;\n  margin-right: 10px;\n}\n.crud-index .search-key ._button {\n  margin-left: 10px;\n}\n.crud-index .crud-adv-btn > .el-button {\n  margin-left: 10px;\n}\n.crud-index .crud-adv-btn > .el-button i {\n  margin-right: 5px;\n}\n.crud-index .data-table {\n  width: 100%;\n}\n.crud-index .data-table .el-table .el-loading-mask .el-loading-spinner .el-icon-loading {\n  font-size: 25px;\n  color: #000;\n}\n.crud-index .data-table .el-table .el-loading-mask .el-loading-spinner .el-loading-text {\n  color: #666;\n  margin-top: 5px;\n}\n.crud-index .data-table .el-table.el-loading-parent--relative {\n  box-sizing: border-box;\n}\n.crud-index .data-table .el-table th {\n  height: 40px;\n  line-height: 40px;\n  padding: 0 !important;\n  background-color: #fdfdfd !important;\n}\n.crud-index .data-table .el-table th:nth-last-child(n + 2) {\n  border-right: 0;\n}\n.crud-index .data-table .el-table th * {\n  font-size: 12px;\n  font-weight: normal;\n  color: #666;\n}\n.crud-index .data-table .el-table td {\n  padding: 8px 0 !important;\n}\n.crud-index .data-table .el-table td * {\n  font-size: 12px;\n}\n.crud-index .crud-query {\n  margin: 0 10px;\n  border-radius: 3px;\n  overflow: hidden;\n  display: flex;\n}\n.crud-index .crud-query button {\n  border: 0;\n  background-color: #fff;\n  font-size: 12px;\n  outline: none;\n  cursor: pointer;\n  color: #666;\n}\n.crud-index .crud-query button:hover {\n  color: #6fa8ff;\n}\n.crud-index .crud-query button.active {\n  color: #409eff;\n}\n.crud-index .crud-query button span {\n  display: inline-block;\n  padding: 0 15px;\n  border-right: 1px solid #ddd;\n}\n.crud-index .crud-query button:last-child span {\n  border: 0;\n}\n.cl-form .el-form-item .el-input-number .el-input-number__decrease,\n.cl-form .el-form-item .el-input-number .el-input-number__increase {\n  border: 0;\n  background-color: transparent;\n}\n.cl-form .el-form-item .el-form-item__content .el-select,\n.cl-form .el-form-item .el-form-item__content .el-input,\n.cl-form .el-form-item .el-form-item__content .el-date-editor,\n.cl-form .el-form-item .el-form-item__content .el-checkbox-group,\n.cl-form .el-form-item .el-form-item__content .el-radio-group,\n.cl-form .el-form-item .el-form-item__content .el-input-number,\n.cl-form .el-form-item .el-form-item__content .el-cascader {\n  width: 100%;\n}\n.el-drawer .crud-adv-search__drawer {\n  width: 500px;\n}\n.el-drawer .crud-adv-search__drawer .crud-adv-search__drawer-container {\n  height: calc(100vh - 175px);\n  overflow-y: auto;\n  margin-bottom: 10px;\n  padding: 10px 20px 10px 10px;\n}\n.el-drawer .crud-adv-search__drawer .crud-adv-search__drawer-footer {\n  display: flex;\n  align-items: center;\n  height: 40px;\n  padding: 10px;\n}\n.el-drawer .crud-adv-search__drawer .crud-adv-search__drawer-footer .el-button {\n  flex: 1;\n}\n.el-drawer.ttb .crud-adv-search__drawer,\n.el-drawer.btt .crud-adv-search__drawer {\n  width: 100%;\n}\n",""])},function(e,t,n){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=function(e,t){var n=e[1]||"",r=e[3];if(!r)return n;if(t&&"function"==typeof btoa){var i=(a=r,s=btoa(unescape(encodeURIComponent(JSON.stringify(a)))),c="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(s),"/*# ".concat(c," */")),o=r.sources.map((function(e){return"/*# sourceURL=".concat(r.sourceRoot).concat(e," */")}));return[n].concat(o).concat([i]).join("\n")}var a,s,c;return[n].join("\n")}(t,e);return t[2]?"@media ".concat(t[2],"{").concat(n,"}"):n})).join("")},t.i=function(e,n){"string"==typeof e&&(e=[[null,e,""]]);for(var r={},i=0;i<this.length;i++){var o=this[i][0];null!=o&&(r[o]=!0)}for(var a=0;a<e.length;a++){var s=e[a];null!=s[0]&&r[s[0]]||(n&&!s[2]?s[2]=n:n&&(s[2]="(".concat(s[2],") and (").concat(n,")")),t.push(s))}},t}},function(e,t,n){"use strict";var r,i={},o=function(){return void 0===r&&(r=Boolean(window&&document&&document.all&&!window.atob)),r},a=function(){var e={};return function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}e[t]=n}return e[t]}}();function s(e,t){for(var n=[],r={},i=0;i<e.length;i++){var o=e[i],a=t.base?o[0]+t.base:o[0],s={css:o[1],media:o[2],sourceMap:o[3]};r[a]?r[a].parts.push(s):n.push(r[a]={id:a,parts:[s]})}return n}function c(e,t){for(var n=0;n<e.length;n++){var r=e[n],o=i[r.id],a=0;if(o){for(o.refs++;a<o.parts.length;a++)o.parts[a](r.parts[a]);for(;a<r.parts.length;a++)o.parts.push(v(r.parts[a],t))}else{for(var s=[];a<r.parts.length;a++)s.push(v(r.parts[a],t));i[r.id]={id:r.id,refs:1,parts:s}}}}function u(e){var t=document.createElement("style");if(void 0===e.attributes.nonce){var r=n.nc;r&&(e.attributes.nonce=r)}if(Object.keys(e.attributes).forEach((function(n){t.setAttribute(n,e.attributes[n])})),"function"==typeof e.insert)e.insert(t);else{var i=a(e.insert||"head");if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(t)}return t}var l,d=(l=[],function(e,t){return l[e]=t,l.filter(Boolean).join("\n")});function f(e,t,n,r){var i=n?"":r.css;if(e.styleSheet)e.styleSheet.cssText=d(t,i);else{var o=document.createTextNode(i),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(o,a[t]):e.appendChild(o)}}function p(e,t,n){var r=n.css,i=n.media,o=n.sourceMap;if(i&&e.setAttribute("media",i),o&&btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),e.styleSheet)e.styleSheet.cssText=r;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(r))}}var h=null,m=0;function v(e,t){var n,r,i;if(t.singleton){var o=m++;n=h||(h=u(t)),r=f.bind(null,n,o,!1),i=f.bind(null,n,o,!0)}else n=u(t),r=p.bind(null,n,t),i=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)};return r(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;r(e=t)}else i()}}e.exports=function(e,t){(t=t||{}).attributes="object"==typeof t.attributes?t.attributes:{},t.singleton||"boolean"==typeof t.singleton||(t.singleton=o());var n=s(e,t);return c(n,t),function(e){for(var r=[],o=0;o<n.length;o++){var a=n[o],u=i[a.id];u&&(u.refs--,r.push(u))}e&&c(s(e,t),t);for(var l=0;l<r.length;l++){var d=r[l];if(0===d.refs){for(var f=0;f<d.parts.length;f++)d.parts[f]();delete i[d.id]}}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(0),o=(r=i)&&r.__esModule?r:{default:r},a=n(1);n(4),t.default={name:"cl-form",props:{options:Object},data:function(){return{items:[],op:{confirmButtonText:"保存",cancelButtonText:"取消",layout:["cancel","confirm"]},props:{size:"small","append-to-body":!0,"close-on-click-modal":!1},form:{},on:{},fn:{},saving:!1,loading:!1,visible:!1}},methods:{open:function(e){var t=this;if(!e)return console.warn("can't open form, because argument is null");var n=e.props,r=e.items,i=e.on,o=e.op;return this.visible=!0,r&&(this.items=r),n&&(0,a.deepMerge)(this.props,n),i&&(this.on=i),o&&(0,a.deepMerge)(this.op,o),this.form={},this.items.forEach((function(e){t.$set(t.form,e.prop,e.value)})),this.emit()},emit:function(){var e=this;return{done:function(){e.saving=!1},data:this.form,items:this.items,save:this.save,close:this.close}},close:function(){this.$refs.form.resetFields(),this.visible=!1,this.saving=!1,this.on.close&&this.on.close()},save:function(){var e=this;this.$refs.form.validate((function(t){t&&(e.on.submit?(e.saving=!0,e.on.submit(e.emit())):console.warn("function[submit] is not fount"))}))}},render:function(){var e=this,t=arguments[0],n=a.renderForm.call(this),r=this.op,i=r.confirmButtonText,s=r.cancelButtonText,c=r.layout;return this.visible&&t("el-dialog",(0,o.default)([{attrs:{visible:this.visible}},{props:this.props,on:{open:this.open,close:this.close}}]),[n,t("template",{slot:"footer"},[c.map((function(n){return"confirm"==n?t("el-button",(0,o.default)([{attrs:{size:e.props.size,type:"success"}},{on:{click:e.save},props:{loading:e.saving,disabled:e.loading}}]),[i]):"cancel"==n?t("el-button",{attrs:{size:e.props.size},on:{click:e.close}},[s]):a.renderLayout.call(e,n)}))])])}}}])}));